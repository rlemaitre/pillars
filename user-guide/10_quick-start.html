<!doctype html>
<html lang="en">
<head>
    
    <!-- sourceuri: user-guide/10_quick-start.html -->
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <meta content="INDEX, FOLLOW" name="ROBOTS">

    <title>Quick Start</title>

    <meta content="Pillars" property="og:title">
    <meta content="Build your backend service in Scala 3 the easy way" property="og:description">
    <meta content="website" property="og:type">
    <meta content="Pillars" property="og:site_name">
    <meta content="Pillars" itemprop="name">
    <meta content="Build your backend service in Scala 3 the easy way" itemprop="description">
    <meta content="summary" name="twitter:card">
    <meta content="@rlemaitre" name="twitter:creator">
    <meta content="Pillars" name="twitter:title">
    <meta content="Build your backend service in Scala 3 the easy way" name="twitter:description">
    <meta property="og:url" content="https://pillars.dev/" />
    <meta property="og:title" content="Pillars" />
    <meta property="og:description" content="Build your backend service in Scala 3 the easy way" />
    <meta property="og:image" content="https://pillars.dev/images/logo.svg" />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Nunito+Sans:300,400,600,700,800,900" rel="stylesheet">
    <link rel="stylesheet" href="../css/asciidoctor.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <link rel="stylesheet" href="../css/scribbler-global.css">
    
        <link rel="stylesheet" href="../css/scribbler-doc.css">
    
    <link rel="author" href="..//humans.txt">

    <!-- favicon generated with https://www.favicon-generator.org/ -->
    <link rel="icon" type="image/svg+xml" href="../favicon.svg">
    <link rel="icon" type="image/png" href="../favicon.png">
    <meta name="theme-color" content="#0a1322">
</head>

<body>

<nav class="header">
    <a href="../"><img src="../images/logo_without_name.svg" width="43"></a>
    <h1 class="logo">Pillars <span class="logo__thin">Doc</span></h1>
    <ul class="menu">
        <div class="menu__item toggle"><span></span></div>
        <li class="menu__item"><a href="../" class="link link--dark"><i class="fa fa-home"></i> Home</a></li>

        <li class="menu__item"><a href="../user-guide/index.html" class="link link--dark"><i class="fa fa-book"></i> User Guide</a></li>

        <li class="menu__item"><a href="../contribute/10_contributing.html" class="link link--dark"><i class="fa fa-book"></i> Contribute</a></li>

        <li class="menu__item"><a href="../api/" class="link link--dark"><i class="fa fa-cogs"></i> API</a></li>
        <li class="menu__item"><a href="https://github.com/rlemaitre/pillars/" class="link link--dark"><i class="fa fa-github"></i> Github</a></li>
        <li class="menu__item">
            <form action="../search.html">
                <input aria-label="Search this site‚Ä¶" autocomplete="off" class="form-control td-search-input"
                       placeholder="Search this site‚Ä¶" type="search" name="q">
            </form>
        </li>
    </ul>
</nav>

<div class="wrapper">
	<aside class="doc__nav">
		
        
                        <ul>
                            <li>
                                <a class="" href="../user-guide/index.html">Overview</a>
                            </li>
                            <li>
                                <a class="active" href="../user-guide/10_quick-start.html">Quick Start</a>
                            </li>
                            <li>
                                Features
                        <ul>
                            <li>
                                <a class="" href="../user-guide/20_features/10_configuration.html">Configuration</a>
                            </li>
                            <li>
                                <a class="" href="../user-guide/20_features/20_logging.html">Logging</a>
                            </li>
                            <li>
                                <a class="" href="../user-guide/20_features/30_probes.html">Probes</a>
                            </li>
                            <li>
                                <a class="" href="../user-guide/20_features/40_api-server.html">API Server</a>
                            </li>
                            <li>
                                <a class="" href="../user-guide/20_features/50_observability.html">Observability</a>
                            </li>
                            <li>
                                <a class="" href="../user-guide/20_features/60_admin-server.html">Admin Server</a>
                            </li>
                        </ul>
                            </li>
                            <li>
                                <a class="" href="../user-guide/30_modules/index.html">Optional Modules</a>
                        <ul>
                            <li>
                                <a class="" href="../user-guide/30_modules/10_db.html">Database Module</a>
                            </li>
                            <li>
                                <a class="" href="../user-guide/30_modules/15_db-migration.html">DB Migration Module</a>
                            </li>
                            <li>
                                <a class="" href="../user-guide/30_modules/20_http-client.html">HTTP Client Module</a>
                            </li>
                            <li>
                                <a class="" href="../user-guide/30_modules/30_flags.html">Feature Flags module</a>
                            </li>
                            <li>
                                <a class="" href="../user-guide/30_modules/40_redis.html">Redis Module</a>
                            </li>
                            <li>
                                <a class="" href="../user-guide/30_modules/41_rabbitmq.html">RabbitMQ Module</a>
                            </li>
                            <li>
                                <a class="" href="../user-guide/30_modules/100_write-your-own-module.html">Write your own module</a>
                            </li>
                        </ul>
                            </li>
                        </ul>

	</aside>
	<article class="doc__content">
		    <nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
        <ol class="breadcrumb spb-1">
            <!--li aria-current="page" class="breadcrumb-item active">
                <a href="https://example.docsy.dev/docs/">Documentation</a>
            </li-->

        </ol>
    </nav>


    <div class="td-content">
        <p>
            
<div class="sect1">
<h2 id="_quick_start">Quick Start</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This documentation needs to be written.
You can help us by <a href="../../contribute/10_contributing.html">contributing to the documentation</a>.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_installation">Installation</h3>
<div class="paragraph">
<p>This library is currently available for Scala binary version 3.3.1.</p>
</div>
<div class="paragraph">
<p>To use the latest version, include the following in your <code>build.sbt</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sbt">libraryDependencies ++= Seq(
  "com.rlemaitre" %% "pillars-core" % "0.4.3"
)</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also add optional modules to your dependencies:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="sbt">libraryDependencies ++= Seq(
  "com.rlemaitre" %% "pillars-db" % "0.4.3",
  "com.rlemaitre" %% "pillars-db-migration" % "0.4.3",
  "com.rlemaitre" %% "pillars-flags" % "0.4.3",
  "com.rlemaitre" %% "pillars-http-client" % "0.4.3"
)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_usage">Usage</h3>
<div class="paragraph">
<p>You can find an example project in the <code>modules/example</code> directory.</p>
</div>
<div class="paragraph">
<p>First, you need to create a <a href="20_features/10_configuration.html">configuration file</a>.
You can find an example in the <code>modules/example/src/main/resources/application.conf</code> file.</p>
</div>
<div class="paragraph">
<p>Then, you can create your entry point by extending the <code>pillars.IOApp</code> trait:</p>
</div>
<div class="listingblock data-noescape">
<div class="content">
<pre class="prettyprint highlight linenums"><code data-lang="scala">object app extends pillars.IOApp(DB, DBMigration, FeatureFlags, HttpClient): // <i class="conum" data-value="1"></i><b>(1)</b>
    def infos: AppInfo = BuildInfo.toAppInfo // <i class="conum" data-value="2"></i><b>(2)</b>

    def run: Run[IO, IO[Unit]] = // <i class="conum" data-value="3"></i><b>(3)</b>
        for
            _ &lt;- logger.info(s"üìö Welcome to ${config.name}!")
            _ &lt;- dbMigration.migrate("classpath:db-migrations") // <i class="conum" data-value="4"></i><b>(4)</b>
            _ &lt;- flag"feature-1".whenEnabled:
                     sessions.use: session =&gt;
                         for
                             date &lt;- session.unique(sql"select now()".query(timestamptz))
                             _    &lt;- logger.info(s"The current date is $date.")
                         yield ()
            _ &lt;- http.get("https://swapi.dev/api/people/1"): response =&gt;
                     for
                         _    &lt;- logger.info(s"Response: ${response.status}")
                         size &lt;- response.body.compile.count
                         _    &lt;- logger.info(s"Body: $size bytes")
                     yield ()
            _ &lt;- server.start(homeController, userController)   // <i class="conum" data-value="5"></i><b>(5)</b>
        yield ()
        end for
    end run
end app</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>EntryPoint</code> trait is a simple trait that provides a <code>main</code> method and initialize the <code>Pillars</code> instance.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>infos</code> defines some metadata about your application.
It is used by the admin server to display information about your application.
See <a href="#_application_metadata">Application Metadata</a> for more information.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>run</code> is the entry point of your application.
Thanks to the <code>Run[F[_], T]</code> context function, you have access to a <code>Pillars[F]</code> instance that contains all your modules.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Each module is accessible through the <code>Pillars</code> instance or through a top-level function in the module&#8217;s package.
The <code>dbMigration.migrate</code> function is a top-level function that is provided by the <code>db-migration</code> module.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The API server must be started with the <code>server.start</code> function with the controllers you want to expose.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Then, you can run your application. For example, you can run it with <code>sbt</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="shell">sbt "example/run"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The log should display something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="console">2024.01.21 22:36:19:0000 [io-comp...] [INFO ] pillars.Pillars.apply:52 - Loading modules...
2024.01.21 22:36:19:0001 [io-comp...] [INFO ] pillars.Pillars.loadModules:87 - Found 2 module loaders: db, feature-flags
2024.01.21 22:36:19:0002 [io-comp...] [INFO ] pillars.db.db.load:57 - Loading DB module
2024.01.21 22:36:19:0003 [io-comp...] [INFO ] pillars.db.db.load:68 - DB module loaded
2024.01.21 22:36:19:0004 [io-comp...] [INFO ] pillars.flags.FlagManager.load:54 - Loading Feature flags module
2024.01.21 22:36:19:0005 [io-comp...] [INFO ] pillars.flags.FlagManager.load:57 - Feature flags module loaded
2024.01.21 22:36:19:0000 [io-comp...] [INFO ] pillars.AdminServer.start:22 - Starting admin server on 0.0.0.0:19876
2024.01.21 22:36:19:0006 [io-comp...] [INFO ] example.app.run:24 - üìö Welcome to Bookstore!
2024.01.21 22:36:19:0000 [io-comp...] [INFO ] example.app.run:29 - The current date is 2024-01-21T22:36:19.695572+01:00.
2024.01.21 22:36:19:0000 [io-comp...] [INFO ] pillars.ApiServer.init:21 - Starting API server on 0.0.0.0:9876
2024.01.21 22:36:19:0001 [io-comp...] [INFO ] org.http4s.netty.server.NettyServerBuilder - Using NIO EventLoopGroup
2024.01.21 22:36:19:0001 [io-comp...] [INFO ] org.http4s.netty.server.NettyServerBuilder - Using NIO EventLoopGroup
2024.01.21 22:36:19:0002 [io-comp...] [INFO ] org.http4s.netty.server.NettyServerBuilder - Started Http4s Netty Server at http://[::]:9876/
2024.01.21 22:36:19:0002 [io-comp...] [INFO ] org.http4s.netty.server.NettyServerBuilder - Started Http4s Netty Server at http://[::]:19876/</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can now access the API at <code><a href="http://localhost:9876" class="bare">http://localhost:9876</a></code> and the admin server at <code><a href="http://localhost:19876" class="bare">http://localhost:19876</a></code>.
For example, to get the readiness porbe status, you can run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="console">$ curl http://localhost:19876/admin/probes/health | jq
{
  "status": "pass",
  "checks": [
    {
      "componentId": "db",
      "componentType": "datastore",
      "status": "pass"
    }
  ]
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_application_metadata">Application Metadata</h3>
<div class="paragraph">
<p>The <code>infos</code> property of the <code>App[F]</code> trait defines some metadata about your application.
You have two ways of defining it:</p>
</div>
<div class="paragraph">
<p>You can directly create an instance of <code>AppInfo</code>:</p>
</div>
<div class="listingblock data-noescape">
<div class="content">
<pre class="prettyprint highlight linenums"><code data-lang="scala">val infos = AppInfo(
  name = App.Name("Bookstore"),
  version = App.Version("1.0.0"),
  description = App.Description("A simple bookstore")
)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or, if you are using the <a href="https://github.com/sbt/sbt-buildinfo">sbt-buildinfo</a> plugin, you can use the <code>BuildInfo</code> object.
In your <code>build.sbt</code>, add the following lines to your project definition:</p>
</div>
<div class="listingblock data-noescape">
<div class="content">
<pre class="prettyprint highlight linenums"><code data-lang="scala">lazy val example = Project("pillars-example", file("modules/example"))
    .enablePlugins(BuildInfoPlugin) // <i class="conum" data-value="1"></i><b>(1)</b>
    .settings(sharedSettings)
    .settings(
      name                   := "pillars-example",                                            // <i class="conum" data-value="2"></i><b>(2)</b>
      description            := "pillars-example is an example of application using pillars", // <i class="conum" data-value="3"></i><b>(3)</b>
      libraryDependencies ++= Dependencies.tests ++ Dependencies.migrationsRuntime, // <i class="conum" data-value="4"></i><b>(4)</b>
      buildInfoKeys          := Seq[BuildInfoKey](name, version, description),                // <i class="conum" data-value="5"></i><b>(5)</b>
      buildInfoOptions       := Seq(BuildInfoOption.Traits("pillars.BuildInfo")),             // <i class="conum" data-value="6"></i><b>(6)</b>
      buildInfoPackage       := "example.build",                                              // <i class="conum" data-value="7"></i><b>(7)</b>
      publish / skip         := true,
      tlMimaPreviousVersions := Set.empty,
      libraryDependencySchemes ++= libDependencySchemes
    )
    .dependsOn(core, dbSkunk, flags, httpClient, dbMigrations)</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Enable the <code>BuildInfo</code> plugin</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Define the name of your application</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Define the description of your application</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Declare the dependencies you want to use in your app.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Tell buildinfo to generate the <code>BuildInfo</code> object including at least <code>name</code>, <code>description</code> and <code>version</code> properties.
In this specific case, <code>version</code> is defined by the <a href="https://github.com/sbt/sbt-dynver">sbt-dynver</a> plugin.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Configure BuildInfo to implement the <code>pillars.BuildInfo</code> trait.
It is required to use the <code>BuildInfo</code> object in your application.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Specify in which package will be generated the <code>BuildInfo</code> object.</td>
</tr>
</table>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you use the <code>db-migration</code> module, you have to add a dependency to your JDBC driver and possibly to a flyway
specific library for your DB (<code>org.flyway:flyway-postgresql</code> for PostgreSQL for example).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Then, you can use the <code>BuildInfo</code> object in your application:</p>
</div>
<div class="listingblock data-noescape">
<div class="content">
<pre class="prettyprint highlight linenums"><code data-lang="scala">import example.build.BuildInfo

  override val infos = BuildInfo.toAppInfo
  override def run(): Run[IO, IO[Unit]] = ???</code></pre>
</div>
</div>
</div>
</div>
</div>
        </p>

        <style>
.feedback--answer {
    display: inline-block;
}

.feedback--answer-no {
    margin-left: 1em;
}

.feedback--response {
    display: none;
    margin-top: 1em;
}

.feedback--response__visible {
    display: block;
}
</style>

<div class="d-print-none">
    <h2 class="feedback--title">Feedback</h2>
    <p class="feedback--question">Was this page helpful?</p>
    <button class="feedback--answer feedback--answer-yes">Yes</button>
    <button class="feedback--answer feedback--answer-no">No</button>
    <p class="feedback--response feedback--response-yes">
        Glad to hear it! Please <a href="https://github.com/FunktionalIO/pillars/issues/new?title=Docs%3A+Feedback+for+%27Quick+Start%27%20%F0%9F%91%8D&body=%0A%0A%5BEnter%20feedback%20here%5D%0A%0A%0A---%0A%23page:user-guide/10_quick-start.adoc">tell us
    how we can improve</a>.
    </p>
    <p class="feedback--response feedback--response-no">
        Sorry to hear that. Please <a href="https://github.com/FunktionalIO/pillars/issues/new?title=Docs%3A+Feedback+for+%27Quick+Start%27%20%F0%9F%91%8E&body=%0A%0A%5BEnter%20feedback%20here%5D%0A%0A%0A---%0A%23page:user-guide/10_quick-start.adoc">tell
    us how we can improve</a>.
    </p>
</div>
<script>
    const yesButton = document.querySelector('.feedback--answer-yes');
    const noButton = document.querySelector('.feedback--answer-no');
    const yesResponse = document.querySelector('.feedback--response-yes');
    const noResponse = document.querySelector('.feedback--response-no');
    const disableButtons = () => {
        yesButton.disabled = true;
        noButton.disabled = true;
    };
    const sendFeedback = (value) => {
        if (typeof ga !== 'function') return;
        const args = {
            command: 'send',
            hitType: 'event',
            category: 'Helpful',
            action: 'click',
            label: window.location.pathname,
            value: value
        };
        ga(args.command, args.hitType, args.category, args.action, args.label, args.value);
    };
    yesButton.addEventListener('click', () => {
        yesResponse.classList.add('feedback--response__visible');
        disableButtons();
        sendFeedback(1);
    });
    noButton.addEventListener('click', () => {
        noResponse.classList.add('feedback--response__visible');
        disableButtons();
        sendFeedback(0);
    });
</script>


        <br>

        <!--div class="text-muted mt-5 pt-3 border-top">Last modified July 3, 2019: <a
                href="https://github.com/google/docsy-example/commit/d6aa89c8b24089d7e6741030864eff209465e896">Added
            links to user guide repo (d6aa89c)</a>
        </div-->
    </div>


    <script src="https://giscus.app/client.js"
            data-repo="rlemaitre/pillars"
            data-repo-id="R_kgDOK-Le0g"
            data-category="Comments"
            data-category-id="DIC_kwDOK-Le0s4Ccs4S"
            data-mapping="pathname"
            data-strict="0"
            data-reactions-enabled="1"
            data-emit-metadata="0"
            data-input-position="top"
            data-theme="light"
            data-lang="en"
            data-loading="lazy"
            crossorigin="anonymous"
            async>
    </script>
	</article>
	<aside class="doc__nav pop-out">
		
<div class="right__nav">

        <div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_quick_start">Quick Start</a>
<ul class="sectlevel2">
<li><a href="#_installation">Installation</a></li>
<li><a href="#_usage">Usage</a></li>
<li><a href="#_application_metadata">Application Metadata</a></li>
</ul>
</li>
</ul>
</div>


    <ul>

        <li>
            <a href="https://github.com/FunktionalIO/pillars/edit/main/docs/user-guide/10_quick-start.adoc" target="_blank"><i class="fa fa-edit fa-fw"></i> Improve this doc</a>
        </li>


        <li>
            <a href="https://github.com/FunktionalIO/pillars/issues/new?title=Docs%3A+Feedback+for+%27Quick+Start%27&body=%0A%0A%5BEnter%20feedback%20here%5D%0A%0A%0A---%0A%23page:%20https://github.com/FunktionalIO/pillars/edit/main/docs/user-guide/10_quick-start.adoc%0A%23branch:%20main" target="_blank">
                <i class="fa fa-github"></i> Create an issue
            </a>
        </li>

    </ul>
</div>

	</aside>
</div>
<footer class="footer">
    <div class="row">
        
        <a href="https://github.com/FunktionalIO/pillars" rel="noopener noreferrer" title="Twitter"><i class="fa fa-github"></i></a>
        
        
        
        
        
        <a href="mailto:mailto:pillars@pillars.dev" rel="noopener noreferrer" target="_blank" title="Email"><i class="fa fa-envelope"></i></a>
        
    </div>
    <div class="row">Made with ‚ù§Ô∏è by the Pillars team<br>Licensed with <a href="https://www.eclipse.org/legal/epl-2.0/">EPL-2.0</a><br>Powered by docToolchain and jBake</div>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/dockerfile.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/gradle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/scala.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/sql.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/yaml.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/xml.min.js"></script>

<script defer data-domain="pillars.dev" src="https://analytics.funktional.io/js/script.js"></script>

<script>hljs.highlightAll();</script>
<script src="../js/scribbler.js"></script>

</body>
</html>
